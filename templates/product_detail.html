{% extends 'base.html' %}
{% load static %}
{% block title %}{{ product.title }} - 中大二手{% endblock %}

{% block content %}
<div class="container mt-5">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'index' %}">首頁</a></li>
            <li class="breadcrumb-item">
                <a href="{% url 'category_products' product.category.id %}">{{ product.category.name }}</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">{{ product.title }}</li>
        </ol>
    </nav>

    <!-- 商品詳細資訊 -->
    <div class="row">
        <div class="col-md-6">
            {% if product.image %}
                <img src="{{ product.image.url }}" class="img-fluid" alt="{{ product.title }}">
            {% else %}
                <img src="{% static 'images/default.jpg' %}" class="img-fluid" alt="預設圖片">
            {% endif %}
        </div>
        <div class="col-md-6">
            <h1 class="mb-4">{{ product.title }}</h1>
            <p class="text-muted">分類: 
                <a href="{% url 'category_products' product.category.id %}">
                    {{ product.category.name }}
                </a>
            </p>
            <p class="text-primary fs-4">價格: ${{ product.price }}</p>
            <p>{{ product.body }}</p>
            <p class="text-muted">
                賣家: 
                <a href="{% url 'seller_profile' product.owner.id %}">
                    {{ product.owner.username }}
                </a>
            </p>

            <!-- 收藏功能區塊 -->
            {% if user.is_authenticated %}
                {% if user in product.favorites.all %}
                    <a href="{% url 'toggle_favorite' product.id %}" class="btn btn-danger">取消收藏</a>
                {% else %}
                    <a href="{% url 'toggle_favorite' product.id %}" class="btn btn-primary">加入收藏</a>
                {% endif %}
            {% else %}
                <p>請先<a href="{% url 'login' %}">登入</a>以收藏此商品</p>
            {% endif %}
        </div>
    </div>

    <!-- 返回分類或首頁 -->
    <div class="mt-4">
        <a href="{% url 'category_products' product.category.id %}" class="btn btn-secondary">返回分類</a>
        <a href="{% url 'index' %}" class="btn btn-secondary">回首頁</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}